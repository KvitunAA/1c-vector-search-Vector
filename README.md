# 1c-vector-search MCP Server (универсальный шаблон)

Этот проект — **обезличенный универсальный шаблон** MCP-сервера `1c-vector-search` для семантического поиска по коду и
метаданным любых конфигураций 1С (КА, ЗУП, УТ, ERP и т.п.).
Все параметры развертывания (адреса хостов, пути к базам/файлам, имена моделей) приведены в виде **шаблонов** и должны быть
заданы в вашем окружении.

## Состав проекта

- `SERVER_METADATA.json` — описание MCP-сервера для клиента (Cursor и т.п.).
- `tools/*.json` — схема MCP-инструментов (search_1c_code, search_1c_metadata и др.).
- `docker-compose.yml` — пример docker-compose для запуска векторной БД и MCP-приложения.
- `.env.example` — пример файла переменных окружения с ОБЕЗЛИЧЕННЫМИ значениями.
- `data/` (создается пользователем) — каталог с артефактами/данными 1С для индексации.

## Обезличивание параметров

В этом шаблоне:

- **Не указаны реальные адреса и пути** — вместо них используются плейсхолдеры (`your-vector-db-host`, `your_vector_db_user` и т.п.).
- **Не указаны реальные имена моделей** — используется абстрактное `EMBEDDING_MODEL_NAME=your-embedding-model-name`.
- **Не зашиты реальные порты/пароли** — все чувствительные данные выносите в `.env`, который **не** коммитится в GitHub.

При установке на любом окружении:

1. Скопируйте этот каталог в свой репозиторий (например, на GitHub).
2. Переименуйте образы в `docker-compose.yml`:
   - `your-vector-db-image:latest` → образ вашей векторной БД.
   - `your-mcp-app-image:latest` → образ вашего MCP-приложения с реализацией вызовов.
3. Создайте файл `.env` на основе `.env.example` и пропишите в нем реальные значения:
   - `VECTOR_DB_URL`, `VECTOR_DB_USER`, `VECTOR_DB_PASSWORD`, `VECTOR_DB_API_KEY`
   - `EMBEDDING_MODEL_NAME`
   - `MCP_USE_SSE`
4. Поместите данные 1С для индексации в папку `data/` (структуру и формат вы определяете в своей реализации).

## Запуск через Docker Compose

```bash
cd 1c-vector-search-KA_Vector
cp .env.example .env
# отредактируйте .env, затем:
docker compose up -d
```

После запуска MCP-приложение будет доступно по порту `8007` (по умолчанию, см. `docker-compose.yml`).

## Подключение MCP-сервера в Cursor

В конфигурации MCP-клиента (например, Cursor) укажите:

- `serverIdentifier`: `1c-vector-search`
- `serverName`: `1c-vector-search`
- URL транспорта MCP: `http://localhost:8007` (или ваш реальный адрес, если измените порт/хост).

## Инструменты (tools)

Все файлы схем MCP-инструментов находятся в каталоге `tools/` и описывают универсальный набор инструментов для
семантического поиска по коду и метаданным 1С:

- `search_1c_code.json` — семантический поиск по коду 1С.
- `search_1c_metadata.json` — поиск объектов метаданных 1С.
- `search_1c_forms.json` — поиск форм конфигурации.
- `search_by_object_name.json` — полная информация по объекту конфигурации.
- `find_1c_method_usage.json` — поиск мест использования метода.
- `graph_stats.json`, `graph_references.json`, `graph_dependencies.json` — инструменты анализа графа зависимостей.
- `get_vectordb_stats.json` — статистика по векторной БД.
- `get_analyst_instructions.json` — инструкция для аналитика по использованию MCP.

Вы можете использовать эти JSON-файлы как есть для описания инструментов MCP-сервера — они не содержат
привязки к конкретным адресам/базам/моделям и не требуют обезличивания.

